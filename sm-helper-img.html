<html><head><meta charset="UTF-8"><link rel="import" href="../simpla/simpla.html"><link rel="import" href="../polymer/polymer.html"></head><body><dom-module id="sm-helper-img">
  <template>
    <style>
:host{overflow:hidden;display:inline-block}img{vertical-align:bottom;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}
</style>
    <img id="source" src$="[[src]]" width$="[[width]]" height$="[[height]]" on-track="_dragImage" on-down="_stopEvent" on-load="_imageLoaded">
  </template>
  <script>/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __webpack_require__(2);


/***/ },
/* 1 */,
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';

	var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();

	function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

	var _helpersUtilsJs = __webpack_require__(3);

	var DEFAULT_SCALE = 1,
	    DEFAULT_TRANSLATE_X = 0,
	    DEFAULT_TRANSLATE_Y = 0,
	    PAN_FINISHED = 'pan-finished';

	/**
	 * Helper Image used within simpla-image
	 * 	emits 'pan-finished'
	 */

	var HelperImage = (function () {
	  function HelperImage() {
	    _classCallCheck(this, HelperImage);
	  }

	  _createClass(HelperImage, [{
	    key: 'beforeRegister',
	    value: function beforeRegister() {
	      this.is = 'sm-helper-img';

	      this.properties = {
	        width: Number,
	        height: Number,
	        src: String,
	        scale: Number,
	        translateX: Number,
	        translateY: Number
	      };
	    }

	    /**
	     * Updates UI with current scale / translateX / translateY
	     * 	will not happen instantly, happens on next animationFrame
	     * @return {Integer} result of requestAnimationFrame
	     */
	  }, {
	    key: '_paint',
	    value: function _paint() {
	      var _this = this;

	      if (this._tick) {
	        cancelAnimationFrame(this._tick);
	        this._tick = null;
	      }

	      this._tick = requestAnimationFrame(function () {
	        var scale = _this.scale;
	        var translateX = _this.translateX;
	        var translateY = _this.translateY;

	        _this.$.source.style.transform = 'scale(' + scale + ') translateX(' + translateX + 'px) translateY(' + translateY + 'px)';
	      });
	    }

	    /**
	     * @type {number}
	     */
	  }, {
	    key: '_resetDimensions',
	    value: function _resetDimensions() {
	      this._width = this.offsetWidth;
	      this._height = this.offsetHeight;

	      this._imgWidth = this.$.source.offsetWidth;
	      this._imgHeight = this.$.source.offsetHeight;
	    }

	    /**
	     * Takes tracking event and updates coordinates.
	     * @param  {CustomEvent} event Tracking event as specified by polymer
	     */
	  }, {
	    key: '_dragImage',
	    value: function _dragImage(event) {
	      var _event$detail = event.detail;
	      var dx = _event$detail.dx;
	      var dy = _event$detail.dy;
	      var ddx = _event$detail.ddx;
	      var ddy = _event$detail.ddy;
	      var state = _event$detail.state;

	      // Only set the bounds on start to reduce calls to getBoundingClientRect
	      if (state === 'start') {
	        this._resetDimensions();
	      }

	      // At the start, we want dx incase it traveled. Just a precaution - probably unecessary.
	      this.translateX += (state === 'start' ? dx : ddx) / this.scale;
	      this.translateY += (state === 'start' ? dy : ddy) / this.scale;

	      if (state === 'end') {
	        this.fire(PAN_FINISHED);
	      }
	    }

	    /**
	     * Stops any event given to it by calling event.preventDefault()
	     * @param  {Event} event Event to stop
	     */
	  }, {
	    key: '_stopEvent',
	    value: function _stopEvent(event) {
	      event.preventDefault();
	    }
	  }, {
	    key: '_imageLoaded',
	    value: function _imageLoaded() {
	      this._resetDimensions();
	    }
	  }, {
	    key: 'scale',
	    get: function get() {
	      return this._scale || DEFAULT_SCALE;
	    },

	    /**
	     * @type {number}
	     */
	    set: function set(value) {
	      var min = this.minScale;

	      if (value < min) {
	        this._scale = parseFloat(min);
	      } else {
	        this._scale = parseFloat(value);
	      }

	      this.translateX += 0;
	      this.translateY += 0;

	      this._paint();
	    }

	    /**
	     * @type {number}
	     */
	  }, {
	    key: 'translateX',
	    get: function get() {
	      return this._translateX || DEFAULT_TRANSLATE_X;
	    },

	    /**
	     * @type {number}
	     */
	    set: function set(value) {
	      this._translateX = (0, _helpersUtilsJs.fitInside)(value, this._bounds.x);
	      this._paint();
	    }

	    /**
	     * @type {number}
	     */
	  }, {
	    key: 'translateY',
	    get: function get() {
	      return this._translateY || DEFAULT_TRANSLATE_Y;
	    },

	    /**
	     * @type {number}
	     */
	    set: function set(value) {
	      this._translateY = (0, _helpersUtilsJs.fitInside)(value, this._bounds.y);
	      this._paint();
	    }

	    /**
	     * @type {number}
	     */
	  }, {
	    key: 'minScale',
	    get: function get() {
	      var scaleHeight = this.height / this.$.source.height,
	          scaleWidth = this.width / this.$.source.width;

	      if (isNaN(scaleHeight) || isNaN(scaleWidth)) {
	        return 1;
	      }

	      return scaleHeight < scaleWidth ? scaleHeight : scaleWidth;
	    }
	  }, {
	    key: '_bounds',
	    get: function get() {
	      if (!(this._imgWidth && this._width && this._imgHeight && this._height)) {
	        return {
	          x: { min: Number.NEGATIVE_INFINITY, max: Number.POSITIVE_INFINITY },
	          y: { min: Number.NEGATIVE_INFINITY, max: Number.POSITIVE_INFINITY }
	        };
	      }

	      return {
	        x: { min: -(this._imgWidth * this.scale - this._width) / this.scale, max: 0 },
	        y: { min: -(this._imgHeight * this.scale - this._height) / this.scale, max: 0 }
	      };
	    }
	  }]);

	  return HelperImage;
	})();

	Polymer(HelperImage);

/***/ },
/* 3 */
/***/ function(module, exports) {

	"use strict";

	Object.defineProperty(exports, "__esModule", {
	  value: true
	});
	exports.fitInside = fitInside;

	function fitInside(value, range) {
	  if (value < range.min) {
	    return range.min;
	  }

	  if (value > range.max) {
	    return range.max;
	  }

	  return value;
	}

/***/ }
/******/ ]);</script>

</dom-module>
</body></html>