<html><head><meta charset="UTF-8"><link rel="import" href="../sm-helper-button/sm-helper-button.html"><link rel="import" href="../simpla/simpla.html"><link rel="import" href="../polymer/polymer.html"></head><body><div hidden by-vulcanize=""><dom-module id="sm-img-canvas" assetpath="../sm-img-canvas/">
  <template>

    <style include="sm-css"></style>
    <style>:host{position:relative;display:inline-block;overflow:hidden;width:100%;height:100%;background:-webkit-linear-gradient(45deg,rgba(0,0,0,.02) 25%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 75%,rgba(0,0,0,.02) 75%,rgba(0,0,0,.02) 0),-webkit-linear-gradient(45deg,rgba(0,0,0,.02) 25%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 75%,rgba(0,0,0,.02) 75%,rgba(0,0,0,.02) 0),rgba(255,255,255,.02);background:linear-gradient(45deg,rgba(0,0,0,.02) 25%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 75%,rgba(0,0,0,.02) 75%,rgba(0,0,0,.02) 0),linear-gradient(45deg,rgba(0,0,0,.02) 25%,rgba(0,0,0,0) 25%,rgba(0,0,0,0) 75%,rgba(0,0,0,.02) 75%,rgba(0,0,0,.02) 0),rgba(255,255,255,.02);background-position:0 0,15px 15px;background-size:30px 30px}:host([active]){cursor:move}:host(:hover)::before{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background:var(--light-white);cursor:pointer;z-index:1}:host([active])::before{display:none}.img{vertical-align:bottom;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0;width:inherit;height:inherit}</style>

    <img id="source" class="img" src$="[[src]]" width$="[[width]]" height$="[[height]]" on-track="_dragImage" on-down="_stopEvent" on-load="_imageLoaded">

  </template>
  <script>!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},,function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),r=1,h=0,o=0,u="pan-finished",c=function(){function t(){s(this,t)}return n(t,[{key:"beforeRegister",value:function(){this.is="sm-img-canvas",this.properties={width:Number,height:Number,src:String,scale:Number,translateX:Number,translateY:Number}}},{key:"_paint",value:function(){var t=this;this._tick&&(cancelAnimationFrame(this._tick),this._tick=null),this._tick=requestAnimationFrame(function(){var e=t.scale,i=t.translateX,s=t.translateY;t.$.source.style.transform="scale("+e+") translateX("+i+"px) translateY("+s+"px)"})}},{key:"_resetDimensions",value:function(){this._width=this.offsetWidth,this._height=this.offsetHeight,this._imgWidth=this.$.source.offsetWidth,this._imgHeight=this.$.source.offsetHeight}},{key:"_dragImage",value:function(t){var e=t.detail,i=e.dx,s=e.dy,n=e.ddx,a=e.ddy,r=e.state;"start"===r&&this._resetDimensions(),this.translateX+=("start"===r?i:n)/this.scale,this.translateY+=("start"===r?s:a)/this.scale,"end"===r&&this.fire(u)}},{key:"_stopEvent",value:function(t){t.preventDefault()}},{key:"_imageLoaded",value:function(){this._resetDimensions()}},{key:"behaviors",get:function(){return[simpla.behaviors.active({reflectToAttribute:!0,notify:!1})]}},{key:"scale",get:function(){return this._scale||r},set:function(t){var e=this.minScale;e>t?this._scale=parseFloat(e):this._scale=parseFloat(t),this.translateX+=0,this.translateY+=0,this._paint()}},{key:"translateX",get:function(){return this._translateX||h},set:function(t){this._translateX=(0,a.fitInside)(t,this._bounds.x),this._paint()}},{key:"translateY",get:function(){return this._translateY||o},set:function(t){this._translateY=(0,a.fitInside)(t,this._bounds.y),this._paint()}},{key:"minScale",get:function(){var t=this.height/this.$.source.height,e=this.width/this.$.source.width;return isNaN(t)||isNaN(e)?1:e>t?t:e}},{key:"_bounds",get:function(){return this._imgWidth&&this._width&&this._imgHeight&&this._height?{x:{min:-(this._imgWidth*this.scale-this._width)/this.scale,max:0},y:{min:-(this._imgHeight*this.scale-this._height)/this.scale,max:0}}:{x:{min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY},y:{min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY}}}}]),t}();Polymer(c)},function(t,e){"use strict";function i(t,e){return t<e.min?e.min:t>e.max?e.max:t}Object.defineProperty(e,"__esModule",{value:!0}),e.fitInside=i}]);</script>
</dom-module>
<dom-module id="sm-img-controls" assetpath="../sm-img-controls/">
  <template>
    <style include="sm-css"></style>
    <style>.toolbox,.zoom__slider{-webkit-box-align:center}.toolbox,.zoom{position:absolute;background:var(--med-white)}:root{--range-height:4px;--thumb-color:var(--blue);--thumb-size:18px;--thumb-border:3px solid white}:host{overflow:visible}.toolbox{display:none;-webkit-align-items:center;-ms-flex-align:center;align-items:center;top:-10px;padding-top:10px;-webkit-transform:translateY(-100%);-ms-transform:translateY(-100%);transform:translateY(-100%)}.toolbox[visible],.zoom__slider{display:-webkit-box;display:-webkit-flex}.toolbox[visible]{display:-ms-flexbox;display:flex}.toolbox__file,.zoom{display:none}:host([position=right]) .toolbox{right:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;border-radius:0 0 0 var(--border-radius)}:host([position=left]) .toolbox{left:0;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;border-radius:0 0 var(--border-radius)}.toolbox__tool{color:var(--med-black);width:var(--tool-size);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.toolbox__tool:hover{color:var(--blue)}.toolbox__title{width:0;color:var(--text-color);-webkit-transition:width 140ms cubic-bezier(.215,.61,.355,1);transition:width 140ms cubic-bezier(.215,.61,.355,1)}.toolbox__title::-webkit-input-placeholder{opacity:0;color:var(--med-black);-webkit-transition:opacity 10ms;transition:opacity 10ms}.toolbox__title::-moz-placeholder{opacity:0;color:var(--med-black);transition:opacity 10ms}.toolbox__title:-ms-input-placeholder{opacity:0;color:var(--med-black);transition:opacity 10ms}.toolbox__title::placeholder{opacity:0;color:var(--med-black);-webkit-transition:opacity 10ms;transition:opacity 10ms}.toolbox__title--expanded::-webkit-input-placeholder{opacity:1;color:var(--med-black);-webkit-transition:opacity 80ms;transition:opacity 80ms}.toolbox__title--expanded::-moz-placeholder{opacity:1;color:var(--med-black);transition:opacity 80ms}.toolbox__title--expanded:-ms-input-placeholder{opacity:1;color:var(--med-black);transition:opacity 80ms}.toolbox__title--expanded::placeholder{opacity:1;color:var(--med-black);-webkit-transition:opacity 80ms;transition:opacity 80ms}.toolbox__title--expanded{width:220px;-webkit-transition:width 140ms cubic-bezier(.215,.61,.355,1);transition:width 140ms cubic-bezier(.215,.61,.355,1)}:host([position=right]) .toolbox__title--expanded{padding-left:14px}:host([position=left]) .toolbox__title--expanded{padding-right:14px}.zoom{left:5%;right:5%;border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);cursor:default;bottom:-10px;padding-bottom:10px;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%)}.zoom[visible]{display:block}.zoom__slider{display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:var(--tool-size);width:90%;margin:0 auto;overflow:hidden}.zoom__slider__input{width:100%}.zoom__slider__input::-webkit-slider-runnable-track{-webkit-appearance:none;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background:var(--med-black);border-radius:999px;width:100%;height:var(--range-height);box-shadow:none;cursor:pointer;border:0;z-index:1}.zoom__slider__input::-moz-range-track{-moz-appearance:none;display:flex;align-items:center;background:var(--med-black);border-radius:999px;width:100%;height:var(--range-height);box-shadow:none;cursor:pointer;border:0;z-index:1}.zoom__slider__input::-ms-track{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;background:var(--med-black);border-radius:999px;width:100%;height:var(--range-height);box-shadow:none;cursor:pointer;border:0;z-index:1}.zoom__slider__input::-webkit-slider-runnable-track:focus{-webkit-appearance:none;outline:0}.zoom__slider__input::-moz-range-track:focus{-moz-appearance:none;outline:0}.zoom__slider__input::-ms-track:focus{outline:0}.zoom__slider__input::-webkit-slider-thumb{-webkit-appearance:none;border-radius:999px;background:var(--thumb-color);box-shadow:none;border:var(--thumb-border);width:var(--thumb-size);height:var(--thumb-size);position:relative;z-index:1}.zoom__slider__input::-moz-range-thumb{-moz-appearance:none;border-radius:999px;background:var(--thumb-color);box-shadow:none;border:var(--thumb-border);width:var(--thumb-size);height:var(--thumb-size);position:relative;z-index:1}.zoom__slider__input::-ms-thumb{border-radius:999px;background:var(--thumb-color);box-shadow:none;border:var(--thumb-border);width:var(--thumb-size);height:var(--thumb-size);position:relative;z-index:1}.zoom__slider__input::-webkit-slider-thumb::before{-webkit-appearance:none;content:'';display:block;height:var(--range-height);width:10000px;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);right:15px;background:var(--thumb-color);pointer-events:none;z-index:-1}.zoom__slider__input::-moz-range-thumb::before{-moz-appearance:none;content:'';display:block;height:var(--range-height);width:10000px;position:absolute;top:50%;transform:translateY(-50%);right:15px;background:var(--thumb-color);pointer-events:none;z-index:-1}.zoom__slider__input::-ms-thumb::before{content:'';display:block;height:var(--range-height);width:10000px;position:absolute;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);right:15px;background:var(--thumb-color);pointer-events:none;z-index:-1}:host(.img--dark) .toolbox,:host(.img--dark) .zoom{background:var(--med-black);color:var(--bright-white)}:host(.img--dark) .toolbax__title,:host(.img--dark) .toolbox__tool:hover{color:#fff}:host(.img--dark) .zoom__slider__input::-webkit-slider-runnable-track{-webkit-appearance:none;background:var(--med-black)}:host(.img--dark) .zoom__slider__input::-moz-range-track{-moz-appearance:none;background:var(--med-black)}:host(.img--dark) .zoom__slider__input::-ms-track{background:var(--med-black)}input[type=range]{-webkit-appearance:none}input[type=range]::-moz-focus-outer{border:0}</style>

    <div class="toolbox" id="controls-top">

      <!-- Image title -->
      <input type="text" id="title" class="toolbox__title" placeholder="Enter image title" value="{{title::input}}">
      <sm-helper-button class="toolbox__tool" on-click="toggleTitle" icon="T"></sm-helper-button>

      <!-- Image upload (file input hidden, since it can't be styled) -->
      <sm-helper-button class="toolbox__tool" icon="" on-tap="openFilePicker">
        <input id="file" class="toolbox__file" type="file" on-change="_filesChanged">
      </sm-helper-button>

    </div>

    <!-- Zoom level slider -->
    <div class="zoom" id="controls-bottom">
      <div class="zoom__slider">
        <input type="range" class="zoom__slider__input" min="1" value="{{zoom::input}}" max="2" step="0.01">
      </div>
    </div>

  </template>
  <script>!function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(4)},,,,function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(5),s=n(r),l="toolbox__title--expanded",u=function(){function t(){o(this,t)}return a(t,[{key:"beforeRegister",value:function(){this.is="sm-img-controls",this.properties={position:{type:String,reflectToAttribute:!0,value:"right"},title:{type:String,notify:!0},file:{type:Object,readonly:!0,notify:!0},zoom:{type:Number,notify:!0}}}},{key:"toggleTitle",value:function(){var t=this.$.title,e=!!t.className.match("\\b"+l+"\\b");this.toggleClass(l,!e,t)}},{key:"openFilePicker",value:function(){this.$.file.click()}},{key:"_activeObserver",value:function(t){t?(this._setPosition(),this.fire("activated")):this.fire("deactivated")}},{key:"_setPosition",value:function(){var t=void 0,e=void 0,i=void 0;t={x:window.outerWidth/2,y:window.outerHeight/2},e=this.getBoundingClientRect(),i={x:e.left+e.width/2,y:e.top+e.height/2},this.position=i.x<t.x?"right":"left"}},{key:"_filesChanged",value:function(t){var e=t.target.files;e&&e[0]&&(this.file=e[0])}},{key:"behaviors",get:function(){return[s["default"],simpla.behaviors.active({observer:"_activeObserver",notify:!1,reflectToAttribute:!0})]}}]),t}();Polymer(u)},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=simpla.constants.easings;e["default"]=Object.defineProperties({listeners:{activated:"_animateIn",deactivated:"_animateOut"},_animateIn:function(){var t=this._animateControls,e=t.top,i=t.bottom,n=this._animateOptions;this.toggleAttribute("visible",!0,e),this.toggleAttribute("visible",!0,i),e.animate([{transform:"translateY(-100%)"},{transform:"translateY(0)"}],n["in"]),i.animate([{transform:"translateY(100%)"},{transform:"translateY(0)"}],n["in"])},_animateOut:function(){var t=this,e=this._animateControls,i=e.top,n=e.bottom,o=this._animateOptions,a=void 0,r=void 0;a=i.animate([{transform:"translateY(0)"},{transform:"translateY(-100%)"}],o.out),r=n.animate([{transform:"translateY(0)"},{transform:"translateY(100%)"}],o.out),a.onfinish=function(){t.toggleAttribute("visible",!1,i)},r.onfinish=function(){t.toggleAttribute("visible",!1,n)}}},{_animateControls:{get:function(){return{top:this.$["controls-top"],bottom:this.$["controls-bottom"]}},configurable:!0,enumerable:!0},_animateOptions:{get:function(){return{"in":{easing:i.easeOutBack,fill:"both",duration:150},out:{easing:i.easeInCubic,fill:"both",duration:120}}},configurable:!0,enumerable:!0}}),t.exports=e["default"]}]);</script>
</dom-module>
</div><dom-module id="simpla-img">
  <template>
    <style include="sm-css"></style>
    <style>:host{overflow:hidden;display:inline-block;height:auto;width:auto;position:relative}</style>

    <sm-img-canvas id="image" src="[[src]]" width="[[width]]" height="[[height]]" scale="[[scale]]" translatex="[[position.x]]" translatey="[[position.y]]" active="[[active]]" on-pan-finished="updatePosition">
    </sm-img-canvas>

    <sm-img-controls id="controls" zoom="{{scale}}" title="{{title}}" active="[[active]]" on-file-changed="_fileChanged">
    </sm-img-controls>

  </template>
  <script>!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e)}return r(e,[{key:"beforeRegister",value:function(){this.is="simpla-img",this.properties={src:String,width:String,height:String,scale:{type:Number,value:1},position:{type:Object,value:{x:0,y:0}}}}},{key:"ready",value:function(){}},{key:"updatePosition",value:function(){var e=this._canvas;this.position={x:e.translateX,y:e.translateY}}},{key:"_fileChanged",value:function(e){var t=this,n=new FileReader,r=e.detail.value;n.onloadend=function(){return t.src=n.result},n.readAsDataURL(r)}},{key:"behaviors",get:function(){return[simpla.behaviors.active()]}},{key:"_canvas",get:function(){return this.$.image}},{key:"_controls",get:function(){return this.$.controls}}]),e}();Polymer(i)}]);</script>
</dom-module>
</body></html>