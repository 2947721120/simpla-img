<html><head><meta charset="UTF-8"><link rel="import" href="../sm-helper-button/sm-helper-button.html"><link rel="import" href="../sm-css/sm-css.html"><link rel="import" href="../polymer/polymer.html"></head><body><div hidden by-vulcanize=""><dom-module id="sm-img-canvas" assetpath="../sm-img-canvas/">
  <template>

    <style include="sm-css"></style>
    <style>:host{overflow:hidden;display:inline-block}.img{vertical-align:bottom;-webkit-transform-origin:0 0;-ms-transform-origin:0 0;transform-origin:0 0}</style>

    <img id="source" class="img" src$="[[src]]" width$="[[width]]" height$="[[height]]" on-track="_dragImage" on-down="_stopEvent" on-load="_imageLoaded">

  </template>
  <script>!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},,function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),a=i(3),r=1,h=0,u=0,o="pan-finished",c=function(){function t(){s(this,t)}return n(t,[{key:"beforeRegister",value:function(){this.is="sm-img-canvas",this.properties={width:Number,height:Number,src:String,scale:Number,translateX:Number,translateY:Number}}},{key:"_paint",value:function(){var t=this;this._tick&&(cancelAnimationFrame(this._tick),this._tick=null),this._tick=requestAnimationFrame(function(){var e=t.scale,i=t.translateX,s=t.translateY;t.$.source.style.transform="scale("+e+") translateX("+i+"px) translateY("+s+"px)"})}},{key:"_resetDimensions",value:function(){this._width=this.offsetWidth,this._height=this.offsetHeight,this._imgWidth=this.$.source.offsetWidth,this._imgHeight=this.$.source.offsetHeight}},{key:"_dragImage",value:function(t){var e=t.detail,i=e.dx,s=e.dy,n=e.ddx,a=e.ddy,r=e.state;"start"===r&&this._resetDimensions(),this.translateX+=("start"===r?i:n)/this.scale,this.translateY+=("start"===r?s:a)/this.scale,"end"===r&&this.fire(o)}},{key:"_stopEvent",value:function(t){t.preventDefault()}},{key:"_imageLoaded",value:function(){this._resetDimensions()}},{key:"scale",get:function(){return this._scale||r},set:function(t){var e=this.minScale;e>t?this._scale=parseFloat(e):this._scale=parseFloat(t),this.translateX+=0,this.translateY+=0,this._paint()}},{key:"translateX",get:function(){return this._translateX||h},set:function(t){this._translateX=(0,a.fitInside)(t,this._bounds.x),this._paint()}},{key:"translateY",get:function(){return this._translateY||u},set:function(t){this._translateY=(0,a.fitInside)(t,this._bounds.y),this._paint()}},{key:"minScale",get:function(){var t=this.height/this.$.source.height,e=this.width/this.$.source.width;return isNaN(t)||isNaN(e)?1:e>t?t:e}},{key:"_bounds",get:function(){return this._imgWidth&&this._width&&this._imgHeight&&this._height?{x:{min:-(this._imgWidth*this.scale-this._width)/this.scale,max:0},y:{min:-(this._imgHeight*this.scale-this._height)/this.scale,max:0}}:{x:{min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY},y:{min:Number.NEGATIVE_INFINITY,max:Number.POSITIVE_INFINITY}}}}]),t}();Polymer(c)},function(t,e){"use strict";function i(t,e){return t<e.min?e.min:t>e.max?e.max:t}Object.defineProperty(e,"__esModule",{value:!0}),e.fitInside=i}]);</script>
</dom-module>
</div><dom-module id="simpla-img">
  <template>
    <style include="sm-css"></style>
    <style>


</style>

    <sm-img-canvas id="image" src="[[src]]" width="[[width]]" height="[[height]]" scale="[[scale]]" translatex="[[position.x]]" translatey="[[position.y]]" on-pan-finished="updatePosition">
    </sm-img-canvas>

      <!-- Edit controls -->
    <div class="controls">

      <!-- Main toolbox -->
      <div class="controls__toolbox">

        <!-- Image title -->
        <input type="text" id="title" class="controls__toolbox__title" placeholder="Enter image title" value="{{title::input}}">
        <simpla-button class="controls__toolbox__tool" on-click="toggleTitle" icon="T"></simpla-button>

        <!-- Image upload (actual file input hidden, since it can't be styled) -->
        <!-- <simpla-button class="controls__toolbox__tool" on-click="openFilePicker" icon="&#xe619;"> -->
        <simpla-button class="controls__toolbox__tool" icon="î˜™">
          <input id="file" class="controls__toolbox__file" type="file" on-change="_fileChosen">
        </simpla-button>

      </div>

      <!-- Zoom level slider -->
      <div class="controls__zoom">
        <div class="controls__zoom__slider">
          <input id="zoom" type="range" class="controls__zoom__slider__input" min="1" value="{{scale::input}}" max="2" step="0.01">
        </div>
      </div>

    </div>

  </template>
  <script>!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){n(this,e)}return r(e,[{key:"beforeRegister",value:function(){this.is="simpla-img",this.properties={src:String,width:String,height:String,scale:{type:Number,value:1},position:{type:Object,value:{x:0,y:0}}}}},{key:"ready",value:function(){this.$.zoom.min=this._helper.minScale}},{key:"updatePosition",value:function(){var e=this._helper;this.position={x:e.translateX,y:e.translateY}}},{key:"_fileChosen",value:function(e){var t=e.target,n=t.files;if(!n)throw new Error("Could not load file");this._loadFile(n[0])}},{key:"_loadFile",value:function(e){var t=this,n=new FileReader;n.onloadend=function(){return t.src=n.result},n.readAsDataURL(e)}},{key:"_helper",get:function(){return this.$.image}}]),e}();Polymer(i)}]);</script>
</dom-module>
</body></html>